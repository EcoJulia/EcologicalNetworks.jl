<!DOCTYPE html>
<html lang="en">
<head>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script>

  <link href="https://use.fontawesome.com/releases/v5.0.2/css/all.css" rel="stylesheet">

  <script src="//code.jquery.com/jquery-latest.min.js"></script>

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <link rel='stylesheet' href='//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css'>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>EcologicalNetwork.jl - Drawing networks</title>
  <link rel="stylesheet" href="/styles/main.css">
</head>

<body>

  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
      <!-- <a class="navbar-brand" href="#">
        <img src="/logo.png" alt="">
      </a> -->
      <a class="navbar-brand" href="/">EcologicalNetwork.jl</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Case studies
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="/casestudies/specificity/">Measuring specificity</a>
              <a class="dropdown-item" href="/casestudies/nestedness/">Nestedness significance</a>
              <a class="dropdown-item" href="/casestudies/betadiv/">Network comparison</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Manual
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="/manual/types/">Types</a>
              <a class="dropdown-item" href="/manual/generalities">Generalities</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="/manual/nestedness/">Measuring nestedness</a>
              <a class="dropdown-item" href="/manual/motifs/">Counting motifs</a>
              <a class="dropdown-item" href="/manual/betadiversity/">Network dissimilarity</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="/manual/data/">Datasets</a>
              <a class="dropdown-item" href="/manual/plots/">Network plots</a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#">API reference</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container maincontent">
    <h1>Drawing networks</h1>
    <p>The network representations have been taken from @McG12. They are not meant to
offer a full network visualisation suite, but they allow to create pictures to
explore network structure. All data visualisation relies on the <code class="highlighter-rouge">Luxor</code> package –
this means that networks can be produced as <code class="highlighter-rouge">.png</code>, <code class="highlighter-rouge">.svg</code>, and <code class="highlighter-rouge">.pdf</code> files.</p>

<p>All layouts have a number of common options, passed as <em>keyword</em> arguments:</p>

<ol>
  <li><code class="highlighter-rouge">filename</code> – the name/path of the figure (defaults to <code class="highlighter-rouge">network.png</code>)</li>
  <li><code class="highlighter-rouge">fontname</code> – the name of the font for labels (defaults to <code class="highlighter-rouge">Noto Sans Condensed</code>)</li>
  <li><code class="highlighter-rouge">fontsize</code> – the size of the font for labels (defaults to <code class="highlighter-rouge">16</code>)</li>
  <li><code class="highlighter-rouge">steps</code> – the number of layout positioning steps to do (defaults to <code class="highlighter-rouge">500</code> for circular, <code class="highlighter-rouge">15000</code> for graph)</li>
  <li><code class="highlighter-rouge">names</code> – whether to display the species names (default to <code class="highlighter-rouge">true</code>) or not</li>
</ol>

<p>Additionally, all functions share similarities in their output. In bipartite
networks, nodes from the top level are orange, and the bottom level nodes are
blue. In unipartite networks, all nodes are green. The colors come from @Won11 –
and have been picked to ensure maximum dissimilarity under normal vision,
deuteranopia, tritanopia, and protanopia. The interaction strength changes the
line width in quantitative networks, and the line opacity in probabilistic
networks.</p>

<p>This page will illustrate the currently implemented layouts using a bipartite
and a unipartite network:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">N</span> <span class="o">=</span> <span class="n">fonseca_ganade_1996</span><span class="x">()</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">thompson_townsend_catlins</span><span class="x">()</span>
</code></pre></div></div>

<h2 id="circular-layout">Circular layout</h2>

<p>In the circular layout, all nodes are laid out on the diameter of a circle.
Nodes that are densely connected are moved together (as much as possible).
Interactions are represented by arcs of constant angle – larger angles mean
that the interactions are essentially lines, and smaller angles have a more
pronounced bend. The parameter regulating the angle is <code class="highlighter-rouge">Θ</code>, which defaults to
<code class="highlighter-rouge">π/3</code>.</p>

<p>Circular layouts have a default number of steps of 500 – this is much more than
needed, in many cases, but this will ensure that larger networks are close to
the “best” layout.</p>

<p>In the circular layout, self-interactions are currently <em>not</em> represented.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">circular_network_plot</span><span class="x">(</span><span class="n">N</span><span class="x">;</span> <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"circular_fg96.png"</span><span class="x">));</span>
</code></pre></div></div>

<p><img src="/figures/circular_fg96.png" alt="Circular layout" /></p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">circular_network_plot</span><span class="x">(</span><span class="n">U</span><span class="x">;</span> <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"circular_ttc.png"</span><span class="x">));</span>
</code></pre></div></div>

<p><img src="/figures/circular_ttc.png" alt="Circular layout" /></p>

<h2 id="graph-layout">Graph layout</h2>

<p>Compared to circular layouts, graph layouts are a whole other beast. You know
how in some recipes, the only way to have it turn out great is to accept that it
will cook for a long time over low heat? Well, graph layouts are like this. We
have hard-coded a very small maximum allowed displacement (the “heat”) per step,
which means that the overall behaviour is much more stable, <em>but</em> we need a lot
of steps to reach an equilibrium.</p>

<p>The graph layout implemented here has three main ingredients: all nodes want to
move away from every other node, connected nodes are brought closer together by
their interactions. and the center is pulling all nodes to itself (with a
strength of one-tenth of an interaction). All of this means that all points will
end up in a circle, and the connected components or modules will be well
isolated from one another. Bipartite networks, in particular, tend to be very
pretty when represented this way.</p>

<p>But it takes time… Specifically, the default number of steps is <code class="highlighter-rouge">15000</code> (this
is often not enough, and we recommend using <code class="highlighter-rouge">60000</code> if you need to make a very
nice figure).</p>

<p>The final product is determined by two parameters: the spring constant <code class="highlighter-rouge">L</code>,
which acts as a sort of <em>scale</em> of the network, and the repulsion/attraction
ratio <code class="highlighter-rouge">R</code>, which determines the coefficient of attraction <em>relative</em> to the
coefficient of repulsion [@McG12]. The defaults values of <code class="highlighter-rouge">L=50</code> and <code class="highlighter-rouge">R=0.05</code>
give generally sensible results (but <code class="highlighter-rouge">R=0.1</code> works well too):</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">graph_network_plot</span><span class="x">(</span><span class="n">trojelsgaard_et_al_2014</span><span class="x">()[</span><span class="mi">2</span><span class="x">];</span>
  <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"graph_tr2.png"</span><span class="x">),</span> <span class="n">steps</span><span class="o">=</span><span class="mi">3500</span><span class="x">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.1</span><span class="x">,</span> <span class="n">names</span><span class="o">=</span><span class="n">false</span><span class="x">);</span>
</code></pre></div></div>

<p><img src="/figures/graph_tr2.png" alt="Circular layout" /></p>

<h2 id="advanced-uses-for-layouts">Advanced uses for layouts</h2>

<h3 id="multiple-networks">Multiple networks</h3>

<p>Plotting a network is a two step process: calculating a layout (<em>i.e.</em> deciding
where the points should be), and the drawing the relevant information. These two
steps are separate, and done by functions called <code class="highlighter-rouge">x_layout</code> and
<code class="highlighter-rouge">x_network_plot</code>. Calling <code class="highlighter-rouge">x_network_plot</code> will use the default parameters, but
one can have a finer control by calling the layout step separately from the
plotting step. Let’s consider the example of two networks – we want to show the
position of the first networks, but we want the layout to reflect our knowledge
of both networks. This can be done by calculating the layout on the union of
both networks, but only plotting the first:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="x">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">trojelsgaard_et_al_2014</span><span class="x">()[</span><span class="mi">1</span><span class="x">:</span><span class="mi">2</span><span class="x">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">reduce</span><span class="x">(</span><span class="n">union</span><span class="x">,</span> <span class="nb">convert</span><span class="o">.</span><span class="x">(</span><span class="n">BinaryNetwork</span><span class="x">,</span> <span class="x">[</span><span class="n">X</span><span class="x">,</span> <span class="n">Y</span><span class="x">]))</span>
<span class="n">m_layout</span> <span class="o">=</span> <span class="n">circular_layout</span><span class="x">(</span><span class="n">M</span><span class="x">)</span>
<span class="n">circular_network_plot</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="n">m_layout</span><span class="x">[</span><span class="mi">2</span><span class="x">];</span> <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"graph_m1.png"</span><span class="x">),</span> <span class="n">names</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">circular_network_plot</span><span class="x">(</span><span class="n">m_layout</span><span class="o">...</span><span class="x">;</span> <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"graph_m2.png"</span><span class="x">),</span> <span class="n">names</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">circular_network_plot</span><span class="x">(</span><span class="n">Y</span><span class="x">,</span> <span class="n">m_layout</span><span class="x">[</span><span class="mi">2</span><span class="x">];</span> <span class="n">filename</span><span class="o">=</span><span class="n">joinpath</span><span class="x">(</span><span class="n">working_path</span><span class="x">,</span> <span class="s">"graph_m3.png"</span><span class="x">),</span> <span class="n">names</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
</code></pre></div></div>

<p>true</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Network 1</th>
      <th style="text-align: center">Both networks</th>
      <th style="text-align: center">Network 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="/figures/graph_m1.png" alt="n1" /></td>
      <td style="text-align: center"><img src="/figures/graph_m2.png" alt="n2" /></td>
      <td style="text-align: center"><img src="/figures/graph_m3.png" alt="n3" /></td>
    </tr>
  </tbody>
</table>


  </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script type="text/javascript">
  $(function () {
    $('[data-toggle="popover"]').popover({html:true})
  })
  $('.popover-dismiss').popover({
    trigger: 'focus'
  })
  </script>
  <script type="text/javascript">

Array.prototype.uav = function()
{
  var n = {},r=[];
  for(var i = 0; i < this.length; i++)
  {
    if (!n[this[i]])
    {
      n[this[i]] = true;
      r.push(this[i]);
    }
  }
  return r;
}

var regexp = /(\[?)(@)(\w+\d{2}\w?)(\]?)/g;

var refs;
jQuery.ajaxSetup({async:false});
gref = function(d) {refs = d; return refs;}
$.getJSON("/references.json", gref);
jQuery.ajaxSetup({async:true});

match = regexp.exec($('.maincontent').text());
while (match != null) {
  var matchedref = match[3];
  var brackets = match[1] == "[";
  var ref = refs.filter(function(a){return a['id'] == matchedref})[0];

  var inline = "";
  inline += ref['author'][0]['family'];
  if (ref['author'].length == 2) {
    inline += " & ";
    inline += ref['author'][1]['family'];
  }
  if (ref['author'].length > 2) {
    inline += " et al.";
  }

  var GOTO = '';
  if (ref['DOI']) {
    var GOTO = "http://dx.doi.org/"+ref['DOI'];
  } else {
    if (ref['URL']) {
      var GOTO = ref['URL'];
    } else {
      var GOTO = "#";
    }
  }

  var pubyear = ref['issued']['date-parts'][0][0];
  reflink = "<a href='" + GOTO + "' title='" + ref['title'] + "' target='_blank' >Read it!</a>";
  btn = '<a tabindex="0" class="biblio-ref" role="button" data-toggle="popover" data-trigger="focus" title="' + inline + ' (' + pubyear + ')" data-content="' + ref['title'] + '<hr />' + reflink + '"><i class="far fa-file-alt"></i></a>';
  pubyear = btn;
  if (brackets) {
    inline = pubyear;
  } else {
    inline = inline + " " + pubyear;
  }


  var new_html = $('.maincontent').html().replace(match[0], inline);
  $('.maincontent').html(function() {return new_html});

  match = regexp.exec($('.maincontent').text());
}

</script>

</body>
</html>
